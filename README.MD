# Property Investment Management API

## Description

Cette API g√®re un syst√®me d'investissement immobilier. Elle permet aux agents de g√©rer des propri√©t√©s et aux investisseurs de consulter et d'investir dans des propri√©t√©s. Les principales fonctionnalit√©s incluent :
- Gestion des propri√©t√©s par les agents (cr√©ation, mise √† jour, suppression).
- Gestion des investissements par les utilisateurs.
- Visualisation du portefeuille (liste des investissements d'un utilisateur).
- Gestion des revenus locatifs et des transactions.

---

## Fonctionnalit√©s

- **Authentification avec JWT** :
  - Connexion pour les agents et les investisseurs.
  - Gestion des r√¥les pour s√©curiser les endpoints.

- **Gestion des propri√©t√©s** :
  - Agents peuvent ajouter, modifier et supprimer des propri√©t√©s.
  - Investisseurs peuvent consulter uniquement les propri√©t√©s ouvertes.

- **Portefeuille utilisateur** :
  - Liste des investissements de l'utilisateur.
  - D√©tails des parts d√©tenues dans chaque propri√©t√©.

- **Transactions financi√®res** :
  - Gestion des d√©p√¥ts, retraits et remboursements.

---

## Pr√©requis

Assurez-vous d'avoir les outils suivants install√©s sur votre machine :
- [Node.js](https://nodejs.org/) (v14 ou sup√©rieur)
- [MySQL](https://www.mysql.com/)

---

## Installation

### 1Ô∏è‚É£ Cloner le projet
```sh
$ git clone https://github.com/DamienBataillard/Architecture.git
$ cd Architecture
```

### 2Ô∏è‚É£ Configurer les variables d'environnement
Cr√©ez un fichier `.env` √† la racine du projet et ajoutez-y les informations suivantes :

```env
# Configuration de la base de donn√©es
DB_HOST=your_database_host
DB_USER=your_database_user
DB_PASSWORD=your_database_password
DB_NAME=your_database_name
DB_PORT=your_database_port

# Configuration du serveur
PORT=your_server_port

# Cl√© secr√®te pour JWT
JWT_SECRET=your_jwt_secret_key

# Cl√© secr√®te Stripe
STRIPE_SECRET_KEY=your_stripe_secret_key

# Configuration SMTP pour l'envoi d'e-mails
SMTP_HOST=your_smtp_host
SMTP_PORT=your_smtp_port
SMTP_USER=your_smtp_email
SMTP_PASS=your_smtp_password
SMTP_SECURE=true_or_false
```

### 3Ô∏è‚É£ Installer les d√©pendances
```sh
$ npm install
```

### 4Ô∏è‚É£ Lancer le serveur
```sh
$ npm start
```

Le serveur sera accessible √† l'adresse **http://localhost:3000** üéâ

---

## üîÑ API Endpoints

### üõ†Ô∏è Authentification
| M√©thode | Endpoint              | Description                      |
|---------|----------------------|----------------------------------|
| POST    | `/api/auth/register` | Inscription d'un utilisateur    |
| POST    | `/api/auth/login`    | Connexion et g√©n√©ration de JWT  |
| GET     | `/api/users`         | Liste des utilisateurs          |

### üè† Gestion des Propri√©t√©s (Agents uniquement)
| M√©thode | Endpoint                | Description                          |
|---------|------------------------|--------------------------------------|
| GET     | `/api/properties`      | Liste des propri√©t√©s accessibles    |
| POST    | `/api/properties`      | Cr√©ation d'une nouvelle propri√©t√©   |
| PUT     | `/api/properties/:id`  | Mise √† jour d'une propri√©t√©         |
| DELETE  | `/api/properties/:id`  | Suppression d'une propri√©t√©         |

### üí∞ Investissements
| M√©thode | Endpoint                | Description                        |
|---------|------------------------|------------------------------------|
| POST    | `/api/investments`     | Cr√©er un nouvel investissement    |
| GET     | `/api/investments/portfolio` | Liste des investissements d'un utilisateur |
| POST    | `/api/refunds/trigger`  | D√©clencher les remboursements     |

### üîÑ Transactions
| M√©thode | Endpoint                | Description                        |
|---------|------------------------|------------------------------------|
| GET     | `/api/transactions/:userId` | Liste des transactions d'un utilisateur |

### üí∞ Wallet & Paiements
| M√©thode | Endpoint                 | Description                         |
|---------|-------------------------|-------------------------------------|
| GET     | `/api/wallets/`         | R√©cup√©rer le solde du portefeuille |
| POST    | `/api/wallets/add-funds` | Ajouter des fonds via Stripe       |

### üí∏ Revenus Locatifs & Remboursements
| M√©thode | Endpoint                | Description                        |
|---------|------------------------|------------------------------------|
| POST    | `/api/rental-income/distribute` | Distribuer les revenus locatifs |

---

## üì© Configuration SMTP (Envoi d'e-mails)

Si vous utilisez **Gmail**, vous devez g√©n√©rer un **Mot de passe d'application** :
1. Activez la **validation en deux √©tapes** sur votre compte Google.
2. G√©n√©rez un **Mot de passe d'application** depuis [Google Account Security](https://myaccount.google.com/security).
3. Utilisez ce mot de passe pour `SMTP_PASS` dans le fichier `.env`.

![Mail de re√ßu](assets/Mail%20de%20re√ßu.png)

